# Authentication认证

设想，最终包含api和web2个方面的安全管理，先实现api的。

支持4种认证方式：token，session，session-token，token-session；优先完成前2种。

自动判断不同环境使用不同认证管理，有redis时默认使用token模式，没有redis时默认使用session模式，同时也支持指定方式。

自定义注解@NoLogin用于排出单个或整个Controller中不需要认证的接口。

# Authorisation授权

权限包含功能权限和数据权限；

一般功能权限包含菜单和功能按钮，这仅仅是前端的伪权限，对应的后端restful资源才是真正的权限控制，包括增删改查功能，可使用路径匹配规则。

> 目前考虑，资源是与权限挂钩的，不与角色挂钩，也就是说创建一个菜单就要分配这个菜单对应的资源权限，角色直接分配菜单功能权限，后期考虑要不要加上资源类的概念，资源过多分配麻烦，可以直接分配一类的资源。

一般数据权限基于组织机构设置，也有基于区域设置的，通用的做法是给每个表加上组织机构外键。

> 注意2点：1是新增数据时的组织机构id来源，有根据新建人的组织机构id，或者某个数据的组织机构id，后期考虑怎么可配置化。
>
> 2是推荐使用like来查询数据，不推荐使用in来查询。这样对组织机构id或区域id就要有一定的分配规律，对他们的增删改需要理清处理逻辑。

## 实现

支持注解@PreAuthorize和url动态匹配2种模式授权。

自定义注解@DataAuthorize用于单个或整个Controller中的接口来实现数据权限；没有此注解的不加入数据权限管理，此注解自动给参数注入分配的权限组织机构id或id集合，是注入类还是注入字段以及能不能自动带入查询有待考虑；也可考虑其他可能，对最终返回结果进行过滤，可能性能不好）。